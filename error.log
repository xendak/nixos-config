warning: Git tree '/home/flakes/Flake' is dirty
building the system configuration...
warning: Git tree '/home/flakes/Flake' is dirty
error:
       … while evaluating call site

       at «none»:0: (source not available)

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:776:24:

          775|     let f = attrPath:
          776|       zipAttrsWith (n: values:
             |                        ^
          777|         let here = attrPath ++ [n]; in

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling 'g'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:595:19:

          594|           g =
          595|             name: value:
             |                   ^
          596|             if isAttrs value && cond value

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:598:20:

          597|               then recurse (path ++ [name]) value
          598|               else f (path ++ [name]) value;
             |                    ^
          599|         in mapAttrs g;

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:248:72:

          247|           # For definitions that have an associated option
          248|           declaredConfig = mapAttrsRecursiveCond (v: ! isOption v) (_: v: v.value) options;
             |                                                                        ^
          249|

       … while evaluating the attribute 'value'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:759:9:

          758|     in warnDeprecation opt //
          759|       { value = builtins.addErrorContext "while evaluating the option `${showOption loc}':" value;
             |         ^
          760|         inherit (res.defsFinal') highestPrio;

       … while evaluating the option `system.build.toplevel':

       … while evaluating the attribute 'mergedValue'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:794:5:

          793|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
          794|     mergedValue =
             |     ^
          795|       if isDefined then

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:788:9:

          787|       in {
          788|         values = defs''';
             |         ^
          789|         inherit (defs'') highestPrio;

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:887:7:

          886|     in {
          887|       values = concatMap (def: if getPrio def == highestPrio then [(strip def)] else []) defs;
             |       ^
          888|       inherit highestPrio;

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:17:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                 ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:28:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                            ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while evaluating definitions from `/nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/nixos/modules/system/activation/top-level.nix':

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:775:137:

          774|         defs' = concatMap (m:
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                                                                         ^
          776|         ) defs;

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating the attribute 'value'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:599:44:

          598|       defnsByName' = byName "config" (module: value:
          599|           [{ inherit (module) file; inherit value; }]
             |                                            ^
          600|         ) configs;

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/nixos/modules/system/activation/top-level.nix:131:12:

          130|   # Replace runtime dependencies
          131|   system = foldr ({ oldDependency, newDependency }: drv:
             |            ^
          132|       pkgs.replaceDependency { inherit oldDependency newDependency drv; }

       … while calling 'foldr'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:53:20:

           52|   */
           53|   foldr = op: nul: list:
             |                    ^
           54|     let

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:60:8:

           59|         else op (elemAt list n) (fold' (n + 1));
           60|     in fold' 0;
             |        ^
           61|

       … while calling 'fold''

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:56:15:

           55|       len = length list;
           56|       fold' = n:
             |               ^
           57|         if n == len

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/nixos/modules/system/activation/top-level.nix:124:50:

          123|
          124|   failedAssertions = map (x: x.message) (filter (x: !x.assertion) config.assertions);
             |                                                  ^
          125|

       … while evaluating the attribute 'assertion'

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/nixos/common.nix:105:28:

          104|       flip map config.assertions (assertion: {
          105|         inherit (assertion) assertion;
             |                            ^
          106|         message = "${user} profile: ${assertion.message}";

       … while evaluating the attribute 'assertion'

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/files.nix:51:9:

           50|       in {
           51|         assertion = dups == [];
             |         ^
           52|         message = ''

       … while evaluating call site

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/files.nix:46:14:

           45|           attrNames
           46|             (filterAttrs (n: v: v > 1)
             |              ^
           47|             (foldAttrs (acc: v: acc + v) 0

       … while calling 'filterAttrs'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:305:5:

          304|     # The attribute set to filter
          305|     set:
             |     ^
          306|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));

       … while evaluating call site

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/files.nix:47:14:

           46|             (filterAttrs (n: v: v > 1)
           47|             (foldAttrs (acc: v: acc + v) 0
             |              ^
           48|             (mapAttrsToList (n: v: { ${v.target} = 1; }) cfg)));

       … while calling 'foldAttrs'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:412:5:

          411|     # A list of attribute sets to fold together by key.
          412|     list_of_attrs:
             |     ^
          413|     foldr (n: a:

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:413:5:

          412|     list_of_attrs:
          413|     foldr (n: a:
             |     ^
          414|         foldr (name: o:

       … while calling 'foldr'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:53:20:

           52|   */
           53|   foldr = op: nul: list:
             |                    ^
           54|     let

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:60:8:

           59|         else op (elemAt list n) (fold' (n + 1));
           60|     in fold' 0;
             |        ^
           61|

       … while calling 'fold''

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/lists.nix:56:15:

           55|       len = length list;
           56|       fold' = n:
             |               ^
           57|         if n == len

       … while evaluating call site

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/files.nix:48:14:

           47|             (foldAttrs (acc: v: acc + v) 0
           48|             (mapAttrsToList (n: v: { ${v.target} = 1; }) cfg)));
             |              ^
           49|         dupsStr = concatStringsSep ", " dups;

       … while calling 'mapAttrsToList'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:538:5:

          537|     # Attribute set to map over.
          538|     attrs:
             |     ^
          539|     map (name: f name attrs.${name}) (attrNames attrs);

       … while evaluating call site

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/files.nix:7:9:

            6|
            7|   cfg = filterAttrs (n: f: f.enable) config.home.file;
             |         ^
            8|

       … while calling 'filterAttrs'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:305:5:

          304|     # The attribute set to filter
          305|     set:
             |     ^
          306|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling 'g'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:595:19:

          594|           g =
          595|             name: value:
             |                   ^
          596|             if isAttrs value && cond value

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:598:20:

          597|               then recurse (path ++ [name]) value
          598|               else f (path ++ [name]) value;
             |                    ^
          599|         in mapAttrs g;

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:248:72:

          247|           # For definitions that have an associated option
          248|           declaredConfig = mapAttrsRecursiveCond (v: ! isOption v) (_: v: v.value) options;
             |                                                                        ^
          249|

       … while evaluating the attribute 'value'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:759:9:

          758|     in warnDeprecation opt //
          759|       { value = builtins.addErrorContext "while evaluating the option `${showOption loc}':" value;
             |         ^
          760|         inherit (res.defsFinal') highestPrio;

       … while evaluating the option `home-manager.users.flakes.home.file':

       … while evaluating the attribute 'mergedValue'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:794:5:

          793|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
          794|     mergedValue =
             |     ^
          795|       if isDefined then

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:788:9:

          787|       in {
          788|         values = defs''';
             |         ^
          789|         inherit (defs'') highestPrio;

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:887:7:

          886|     in {
          887|       values = concatMap (def: if getPrio def == highestPrio then [(strip def)] else []) defs;
             |       ^
          888|       inherit highestPrio;

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:17:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                 ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:28:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                            ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while evaluating definitions from `/nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/misc/xdg.nix':

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:775:137:

          774|         defs' = concatMap (m:
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                                                                         ^
          776|         ) defs;

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:848:7:

          847|     if def._type or "" == "merge" then
          848|       concatMap dischargeProperties def.contents
             |       ^
          849|     else if def._type or "" == "if" then

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating call site

       at /nix/store/jy7k3aw3gg8gmhkx2kggv779w0d7aizd-source/modules/misc/xdg.nix:122:10:

          121|       home.file = mkMerge [
          122|         (mapAttrs' (name: file: nameValuePair "${cfg.configHome}/${name}" file)
             |          ^
          123|           cfg.configFile)

       … while calling 'mapAttrs''

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:518:5:

          517|     # Attribute set to map over.
          518|     set:
             |     ^
          519|     listToAttrs (map (attr: f attr set.${attr}) (attrNames set));

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling 'g'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:595:19:

          594|           g =
          595|             name: value:
             |                   ^
          596|             if isAttrs value && cond value

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:598:20:

          597|               then recurse (path ++ [name]) value
          598|               else f (path ++ [name]) value;
             |                    ^
          599|         in mapAttrs g;

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:248:72:

          247|           # For definitions that have an associated option
          248|           declaredConfig = mapAttrsRecursiveCond (v: ! isOption v) (_: v: v.value) options;
             |                                                                        ^
          249|

       … while evaluating the attribute 'value'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:759:9:

          758|     in warnDeprecation opt //
          759|       { value = builtins.addErrorContext "while evaluating the option `${showOption loc}':" value;
             |         ^
          760|         inherit (res.defsFinal') highestPrio;

       … while evaluating the option `home-manager.users.flakes.xdg.configFile':

       … while evaluating the attribute 'mergedValue'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:794:5:

          793|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
          794|     mergedValue =
             |     ^
          795|       if isDefined then

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:788:9:

          787|       in {
          788|         values = defs''';
             |         ^
          789|         inherit (defs'') highestPrio;

       … while evaluating the attribute 'values'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:887:7:

          886|     in {
          887|       values = concatMap (def: if getPrio def == highestPrio then [(strip def)] else []) defs;
             |       ^
          888|       inherit highestPrio;

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:17:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                 ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:774:28:

          773|         # Process mkMerge and mkIf properties.
          774|         defs' = concatMap (m:
             |                            ^
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while evaluating definitions from `/nix/store/xnc4lmxf2ym9cs1l25j739wcvqvzrd7k-source/snow/flakes/setup.nix':

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:775:137:

          774|         defs' = concatMap (m:
          775|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                                                                         ^
          776|         ) defs;

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:852:11:

          851|         if def.condition then
          852|           dischargeProperties def.content
             |           ^
          853|         else

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:848:7:

          847|     if def._type or "" == "merge" then
          848|       concatMap dischargeProperties def.contents
             |       ^
          849|     else if def._type or "" == "if" then

       … while calling 'dischargeProperties'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:846:25:

          845|   */
          846|   dischargeProperties = def:
             |                         ^
          847|     if def._type or "" == "merge" then

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling anonymous lambda

       at /nix/store/xnc4lmxf2ym9cs1l25j739wcvqvzrd7k-source/modules/home-manager/neovim.nix:424:17:

          423|         in mkMerge (
          424|           (map (x: x.runtime) pluginsNormalized) ++
             |                 ^
          425|           [

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling 'g'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/attrsets.nix:595:19:

          594|           g =
          595|             name: value:
             |                   ^
          596|             if isAttrs value && cond value

       … while evaluating call site

       at «none»:0: (source not available)

       … while calling anonymous lambda

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:659:37:

          658|
          659|       matchedOptions = mapAttrs (n: v: v.matchedOptions) resultsByName;
             |                                     ^
          660|

       … while evaluating the attribute 'matchedOptions'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:629:15:

          628|             in {
          629|               matchedOptions = evalOptionValue loc opt defns';
             |               ^
          630|               unmatchedDefns = [];

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:629:32:

          628|             in {
          629|               matchedOptions = evalOptionValue loc opt defns';
             |                                ^
          630|               unmatchedDefns = [];

       … while calling 'evalOptionValue'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:730:31:

          729|      config value. */
          730|   evalOptionValue = loc: opt: defs:
             |                               ^
          731|     let

       … while evaluating call site

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:755:9:

          754|       warnDeprecation =
          755|         warnIf (opt.type.deprecationMessage != null)
             |         ^
          756|           "The type `types.${opt.type.name}' of option `${showOption loc}' defined in ${showFiles opt.declarations} is deprecated. ${opt.type.deprecationMessage}";

       … while calling 'warnIf'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/trivial.nix:357:18:

          356|   */
          357|   warnIf = cond: msg: if cond then warn msg else x: x;
             |                  ^
          358|

       … while evaluating the attribute 'type.deprecationMessage'

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:909:19:

          908|     if opt.type.getSubModules or null == null
          909|     then opt // { type = opt.type or types.unspecified; }
             |                   ^
          910|     else opt // { type = opt.type.substSubModules opt.options; options = []; };

       error: value is a function while a set was expected

       at /nix/store/bzjkbaqvbdv09p7bmwinjkbjjk8nbb3x-source/lib/modules.nix:755:17:

          754|       warnDeprecation =
          755|         warnIf (opt.type.deprecationMessage != null)
             |                 ^
          756|           "The type `types.${opt.type.name}' of option `${showOption loc}' defined in ${showFiles opt.declarations} is deprecated. ${opt.type.deprecationMessage}";
